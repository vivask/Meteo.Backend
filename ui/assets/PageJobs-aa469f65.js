import{u as Xt,d as Gt,Q as Zt}from"./QTooltip-cd4ef32e.js";import{c as m,j as ft,_ as St,be as Vt,a0 as Pt,bx as xt,r as S,w as oe,aH as ea,q as Ht,m as s,n as ht,by as $t,aX as ta,a9 as $e,T as mt,S as B,E as et,bs as aa,b3 as yt,ak as la,K as tt,o as ae,f as gt,aZ as na,g as ke,L as x,M as h,aT as pt,b0 as jt,b2 as Tt,aS as bt,k as Ot,N as Yt,O as ve,b7 as oa,aQ as Ue,a_ as st,X as _e,a8 as ua,a6 as kt,R as At,aW as ia,Y as ra,a7 as Fe}from"./vendor-7e3b54f2.js";import{b as Ne,Q as It,a as Ze}from"./QTable-f6f16d1c.js";import{U as sa}from"./UiBox-438aefea.js";import{U as Bt}from"./UiRoundBtn-7ea8dd22.js";import{t as da}from"./tableWrapper-c43f1a46.js";import{j as me}from"./jwtClient-fdc6c2bb.js";import{u as ca}from"./useTableHandlers-649b36f2.js";import{T as va,C as Ct}from"./TouchPan-af4691ff.js";import{t as ma,_ as Ee,f as Ft,a as qt,g as fa,j as dt,d as ct,u as ha}from"./useUtils-85085a27.js";import{p as L}from"./format-3895543d.js";import{a as ya}from"./QMenu-7e13e904.js";import{Q as Ut}from"./QForm-dd93a313.js";import{U as Et}from"./UiInput-ff5536f7.js";import{u as Nt}from"./useSubmitForm-841c2b76.js";import{u as ga}from"./useConfirmDialog-7754cf44.js";import{_ as at}from"./index-dc2fb6bd.js";import"./QMarkupTable-3806441a.js";import"./QChip-dc1c4db6.js";import"./QItemLabel-0efd9dc5.js";import"./QItemSection-cefe5148.js";import"./NetworkError-b28af479.js";const pa="/schedule/jobs";function ba(e){return da(pa,e)}function wa(e,u){me.put("/schedule/jobs",u).then(({success:p,result:V})=>{p&&(u.id=V.id,u.active=V.activate,e.value.push(u))})}function _a(e,u){me.post("/schedule/jobs",u).then(({success:p,result:V})=>{if(p){const q=e.value.findIndex(A=>A.id===u.id);u.active=V.activate,e.value[q]=u}})}function ka(e){if(e.active){const u="/schedule/job/deactivate/"+e.id;me.put(u).then(({success:p})=>{p&&(e.active=!1)})}else{const u="/schedule/job/activate/"+e.id;me.put(u).then(({success:p})=>{p&&(e.active=!0)})}}async function Ca(e){const u="/schedule/job/run/"+e;return await me.put(u).then(({success:p})=>p).catch(()=>!1)}const qa=["gregorian","persian"],Qt={modelValue:{required:!0},mask:{type:String},locale:Object,calendar:{type:String,validator:e=>qa.includes(e),default:"gregorian"},landscape:Boolean,color:String,textColor:String,square:Boolean,flat:Boolean,bordered:Boolean,readonly:Boolean,disable:Boolean},zt=["update:modelValue"];function se(e){return e.year+"/"+L(e.month)+"/"+L(e.day)}function Jt(e,u){const p=m(()=>e.disable!==!0&&e.readonly!==!0),V=m(()=>e.editable===!0?0:-1),q=m(()=>{const b=[];return e.color!==void 0&&b.push(`bg-${e.color}`),e.textColor!==void 0&&b.push(`text-${e.textColor}`),b.join(" ")});function A(){return e.locale!==void 0?{...u.lang.date,...e.locale}:u.lang.date}function v(b){const Y=new Date,r=b===!0?null:0;if(e.calendar==="persian"){const $=ma(Y);return{year:$.jy,month:$.jm,day:$.jd}}return{year:Y.getFullYear(),month:Y.getMonth()+1,day:Y.getDate(),hour:r,minute:r,second:r,millisecond:r}}return{editable:p,tabindex:V,headerClass:q,getLocale:A,getCurrentDate:v}}function Ma(e,u){if(e.hour!==null){if(e.minute===null)return"minute";if(u===!0&&e.second===null)return"second"}return"hour"}function Da(){const e=new Date;return{hour:e.getHours(),minute:e.getMinutes(),second:e.getSeconds(),millisecond:e.getMilliseconds()}}const Sa=ft({name:"QTime",props:{...St,...Vt,...Qt,mask:{default:null},format24h:{type:Boolean,default:null},defaultDate:{type:String,validator:e=>/^-?[\d]+\/[0-1]\d\/[0-3]\d$/.test(e)},options:Function,hourOptions:Array,minuteOptions:Array,secondOptions:Array,withSeconds:Boolean,nowBtn:Boolean},emits:zt,setup(e,{slots:u,emit:p}){const V=ht(),{$q:q}=V.proxy,A=Pt(e,q),{tabindex:v,headerClass:b,getLocale:Y,getCurrentDate:r}=Jt(e,q),$=xt(e),M=$t($);let E,G;const Z=S(null),P=m(()=>ze()),D=m(()=>Y()),fe=m(()=>qe()),ue=Ee(e.modelValue,P.value,D.value,e.calendar,fe.value),w=S(Ma(ue)),l=S(ue),y=S(ue.hour===null||ue.hour<12),le=m(()=>`q-time q-time--${e.landscape===!0?"landscape":"portrait"}`+(A.value===!0?" q-time--dark q-dark":"")+(e.disable===!0?" disabled":e.readonly===!0?" q-time--readonly":"")+(e.bordered===!0?" q-time--bordered":"")+(e.square===!0?" q-time--square no-border-radius":"")+(e.flat===!0?" q-time--flat no-shadow":"")),W=m(()=>{const o=l.value;return{hour:o.hour===null?"--":N.value===!0?L(o.hour):String(y.value===!0?o.hour===0?12:o.hour:o.hour>12?o.hour-12:o.hour),minute:o.minute===null?"--":L(o.minute),second:o.second===null?"--":L(o.second)}}),N=m(()=>e.format24h!==null?e.format24h:q.lang.date.format24h),je=m(()=>{const o=w.value==="hour",i=o===!0?12:60,g=l.value[w.value];let j=`rotate(${Math.round(g*(360/i))-180}deg) translateX(-50%)`;return o===!0&&N.value===!0&&l.value.hour>=12&&(j+=" scale(.7)"),{transform:j}}),he=m(()=>l.value.hour!==null),Q=m(()=>he.value===!0&&l.value.minute!==null),ye=m(()=>e.hourOptions!==void 0?o=>e.hourOptions.includes(o):e.options!==void 0?o=>e.options(o,null,null):null),X=m(()=>e.minuteOptions!==void 0?o=>e.minuteOptions.includes(o):e.options!==void 0?o=>e.options(l.value.hour,o,null):null),ee=m(()=>e.secondOptions!==void 0?o=>e.secondOptions.includes(o):e.options!==void 0?o=>e.options(l.value.hour,l.value.minute,o):null),z=m(()=>{if(ye.value===null)return null;const o=ge(0,11,ye.value),i=ge(12,11,ye.value);return{am:o,pm:i,values:o.values.concat(i.values)}}),ie=m(()=>X.value!==null?ge(0,59,X.value):null),U=m(()=>ee.value!==null?ge(0,59,ee.value):null),te=m(()=>{switch(w.value){case"hour":return z.value;case"minute":return ie.value;case"second":return U.value}}),Ce=m(()=>{let o,i,g=0,k=1;const j=te.value!==null?te.value.values:void 0;w.value==="hour"?N.value===!0?(o=0,i=23):(o=0,i=11,y.value===!1&&(g=12)):(o=0,i=55,k=5);const K=[];for(let C=o,O=o;C<=i;C+=k,O++){const R=C+g,Ge=j!==void 0&&j.includes(R)===!1,Pe=w.value==="hour"&&C===0?N.value===!0?"00":"12":C;K.push({val:R,index:O,disable:Ge,label:Pe})}return K}),Te=m(()=>[[va,ne,void 0,{stop:!0,prevent:!0,mouse:!0}]]);oe(()=>e.modelValue,o=>{const i=Ee(o,P.value,D.value,e.calendar,fe.value);(i.dateHash!==l.value.dateHash||i.timeHash!==l.value.timeHash)&&(l.value=i,i.hour===null?w.value="hour":y.value=i.hour<12)}),oe([P,D],()=>{et(()=>{Ie()})});function de(){const o={...r(),...Da()};Ie(o),Object.assign(l.value,o),w.value="hour"}function ge(o,i,g){const k=Array.apply(null,{length:i+1}).map((j,K)=>{const C=K+o;return{index:C,val:g(C)===!0}}).filter(j=>j.val===!0).map(j=>j.index);return{min:k[0],max:k[k.length-1],values:k,threshold:i+1}}function Qe(o,i,g){const k=Math.abs(o-i);return Math.min(k,g-k)}function Oe(o,{min:i,max:g,values:k,threshold:j}){if(o===i)return i;if(o<i||o>g)return Qe(o,i,j)<=Qe(o,g,j)?i:g;const K=k.findIndex(R=>o<=R),C=k[K-1],O=k[K];return o-C<=O-o?C:O}function ze(){return e.calendar!=="persian"&&e.mask!==null?e.mask:`HH:mm${e.withSeconds===!0?":ss":""}`}function qe(){if(typeof e.defaultDate!="string"){const o=r(!0);return o.dateHash=se(o),o}return Ee(e.defaultDate,"YYYY/MM/DD",void 0,e.calendar)}function Me(){return ta(V)===!0||te.value!==null&&(te.value.values.length===0||w.value==="hour"&&N.value!==!0&&z.value[y.value===!0?"am":"pm"].values.length===0)}function Ye(){const o=Z.value,{top:i,left:g,width:k}=o.getBoundingClientRect(),j=k/2;return{top:i+j,left:g+j,dist:j*.7}}function ne(o){if(Me()!==!0){if(o.isFirst===!0){E=Ye(),G=I(o.evt,E);return}G=I(o.evt,E,G),o.isFinal===!0&&(E=!1,G=null,Je())}}function Je(){w.value==="hour"?w.value="minute":e.withSeconds&&w.value==="minute"&&(w.value="second")}function I(o,i,g){const k=ea(o),j=Math.abs(k.top-i.top),K=Math.sqrt(Math.pow(Math.abs(k.top-i.top),2)+Math.pow(Math.abs(k.left-i.left),2));let C,O=Math.asin(j/K)*(180/Math.PI);if(k.top<i.top?O=i.left<k.left?90-O:270+O:O=i.left<k.left?O+90:270-O,w.value==="hour"){if(C=O/30,z.value!==null){const R=N.value!==!0?y.value===!0:z.value.am.values.length>0&&z.value.pm.values.length>0?K>=i.dist:z.value.am.values.length>0;C=Oe(C+(R===!0?0:12),z.value[R===!0?"am":"pm"])}else C=Math.round(C),N.value===!0?K<i.dist?C<12&&(C+=12):C===12&&(C=0):y.value===!0&&C===12?C=0:y.value===!1&&C!==12&&(C+=12);N.value===!0&&(y.value=C<12)}else C=Math.round(O/6)%60,w.value==="minute"&&ie.value!==null?C=Oe(C,ie.value):w.value==="second"&&U.value!==null&&(C=Oe(C,U.value));return g!==C&&Ke[w.value](C),C}const F={hour(){w.value="hour"},minute(){w.value="minute"},second(){w.value="second"}};function Ae(o){o.keyCode===13&&Le()}function De(o){o.keyCode===13&&We()}function Re(o){Me()!==!0&&(q.platform.is.desktop!==!0&&I(o,Ye()),Je())}function pe(o){Me()!==!0&&I(o,Ye())}function J(o){if(o.keyCode===13)w.value="hour";else if([37,39].includes(o.keyCode)){const i=o.keyCode===37?-1:1;if(z.value!==null){const g=N.value===!0?z.value.values:z.value[y.value===!0?"am":"pm"].values;if(g.length===0)return;if(l.value.hour===null)Se(g[0]);else{const k=(g.length+g.indexOf(l.value.hour)+i)%g.length;Se(g[k])}}else{const g=N.value===!0?24:12,k=N.value!==!0&&y.value===!1?12:0,j=l.value.hour===null?-i:l.value.hour;Se(k+(24+j+i)%g)}}}function lt(o){if(o.keyCode===13)w.value="minute";else if([37,39].includes(o.keyCode)){const i=o.keyCode===37?-1:1;if(ie.value!==null){const g=ie.value.values;if(g.length===0)return;if(l.value.minute===null)be(g[0]);else{const k=(g.length+g.indexOf(l.value.minute)+i)%g.length;be(g[k])}}else{const g=l.value.minute===null?-i:l.value.minute;be((60+g+i)%60)}}}function nt(o){if(o.keyCode===13)w.value="second";else if([37,39].includes(o.keyCode)){const i=o.keyCode===37?-1:1;if(U.value!==null){const g=U.value.values;if(g.length===0)return;if(l.value.seconds===null)Ve(g[0]);else{const k=(g.length+g.indexOf(l.value.second)+i)%g.length;Ve(g[k])}}else{const g=l.value.second===null?-i:l.value.second;Ve((60+g+i)%60)}}}function Se(o){l.value.hour!==o&&(l.value.hour=o,re())}function be(o){l.value.minute!==o&&(l.value.minute=o,re())}function Ve(o){l.value.second!==o&&(l.value.second=o,re())}const Ke={hour:Se,minute:be,second:Ve};function Le(){y.value===!1&&(y.value=!0,l.value.hour!==null&&(l.value.hour-=12,re()))}function We(){y.value===!0&&(y.value=!1,l.value.hour!==null&&(l.value.hour+=12,re()))}function re(){if(ye.value!==null&&ye.value(l.value.hour)!==!0){l.value=Ee(),w.value="hour";return}if(X.value!==null&&X.value(l.value.minute)!==!0){l.value.minute=null,l.value.second=null,w.value="minute";return}if(e.withSeconds===!0&&ee.value!==null&&ee.value(l.value.second)!==!0){l.value.second=null,w.value="second";return}l.value.hour===null||l.value.minute===null||e.withSeconds===!0&&l.value.second===null||Ie()}function Ie(o){const i=Object.assign({...l.value},o),g=e.calendar==="persian"?L(i.hour)+":"+L(i.minute)+(e.withSeconds===!0?":"+L(i.second):""):Ft(new Date(i.year,i.month===null?null:i.month-1,i.day,i.hour,i.minute,i.second,i.millisecond),P.value,D.value,i.year,i.timezoneOffset);i.changed=g!==e.modelValue,p("update:modelValue",g,i)}function Xe(){const o=[s("div",{class:"q-time__link "+(w.value==="hour"?"q-time__link--active":"cursor-pointer"),tabindex:v.value,onClick:F.hour,onKeyup:J},W.value.hour),s("div",":"),s("div",he.value===!0?{class:"q-time__link "+(w.value==="minute"?"q-time__link--active":"cursor-pointer"),tabindex:v.value,onKeyup:lt,onClick:F.minute}:{class:"q-time__link"},W.value.minute)];e.withSeconds===!0&&o.push(s("div",":"),s("div",Q.value===!0?{class:"q-time__link "+(w.value==="second"?"q-time__link--active":"cursor-pointer"),tabindex:v.value,onKeyup:nt,onClick:F.second}:{class:"q-time__link"},W.value.second));const i=[s("div",{class:"q-time__header-label row items-center no-wrap",dir:"ltr"},o)];return N.value===!1&&i.push(s("div",{class:"q-time__header-ampm column items-between no-wrap"},[s("div",{class:"q-time__link "+(y.value===!0?"q-time__link--active":"cursor-pointer"),tabindex:v.value,onClick:Le,onKeyup:Ae},"AM"),s("div",{class:"q-time__link "+(y.value!==!0?"q-time__link--active":"cursor-pointer"),tabindex:v.value,onClick:We,onKeyup:De},"PM")])),s("div",{class:"q-time__header flex flex-center no-wrap "+b.value},i)}function Be(){const o=l.value[w.value];return s("div",{class:"q-time__content col relative-position"},[s($e,{name:"q-transition--scale"},()=>s("div",{key:"clock"+w.value,class:"q-time__container-parent absolute-full"},[s("div",{ref:Z,class:"q-time__container-child fit overflow-hidden"},[mt(s("div",{class:"q-time__clock cursor-pointer non-selectable",onClick:Re,onMousedown:pe},[s("div",{class:"q-time__clock-circle fit"},[s("div",{class:"q-time__clock-pointer"+(l.value[w.value]===null?" hidden":e.color!==void 0?` text-${e.color}`:""),style:je.value}),Ce.value.map(i=>s("div",{class:`q-time__clock-position row flex-center q-time__clock-pos-${i.index}`+(i.val===o?" q-time__clock-position--active "+b.value:i.disable===!0?" q-time__clock-position--disable":"")},[s("span",i.label)]))])]),Te.value)])])),e.nowBtn===!0?s(B,{class:"q-time__now-button absolute",icon:q.iconSet.datetime.now,unelevated:!0,size:"sm",round:!0,color:e.color,textColor:e.textColor,tabindex:v.value,onClick:de}):null])}return V.proxy.setNow=de,()=>{const o=[Be()],i=Ht(u.default);return i!==void 0&&o.push(s("div",{class:"q-time__actions"},i)),e.name!==void 0&&e.disable!==!0&&M(o,"push"),s("div",{class:le.value,tabindex:-1},[Xe(),s("div",{class:"q-time__main col overflow-auto"},o)])}}}),Mt=ft({name:"QPopupProxy",props:{...Xt,breakpoint:{type:[String,Number],default:450}},emits:["show","hide"],setup(e,{slots:u,emit:p,attrs:V}){const{proxy:q}=ht(),{$q:A}=q,v=S(!1),b=S(null),Y=m(()=>parseInt(e.breakpoint,10)),{canShow:r}=Gt({showing:v});function $(){return A.screen.width<Y.value||A.screen.height<Y.value?"dialog":"menu"}const M=S($()),E=m(()=>M.value==="menu"?{maxHeight:"99vh"}:{});oe(()=>$(),P=>{v.value!==!0&&(M.value=P)});function G(P){v.value=!0,p("show",P)}function Z(P){v.value=!1,M.value=$(),p("hide",P)}return Object.assign(q,{show(P){r(P)===!0&&b.value.show(P)},hide(P){b.value.hide(P)},toggle(P){b.value.toggle(P)}}),aa(q,"currentComponent",()=>({type:M.value,ref:b.value})),()=>{const P={ref:b,...E.value,...V,onShow:G,onHide:Z};let D;return M.value==="dialog"?D=yt:(D=ya,Object.assign(P,{target:e.target,contextMenu:e.contextMenu,noParentEvent:!0,separateClosePopup:!0})),s(D,P,u.default)}}});function Va(){const e=new Map;return{getCache:function(u,p){return e[u]===void 0?e[u]=p:e[u]},getCacheWithFn:function(u,p){return e[u]===void 0?e[u]=p():e[u]}}}const we=20,Pa=["Calendar","Years","Months"],Dt=e=>Pa.includes(e),vt=e=>/^-?[\d]+\/[0-1]\d$/.test(e),He=" — ";function ce(e){return e.year+"/"+L(e.month)}const xa=ft({name:"QDate",props:{...Qt,...Vt,...St,multiple:Boolean,range:Boolean,title:String,subtitle:String,mask:{default:"YYYY/MM/DD"},defaultYearMonth:{type:String,validator:vt},yearsInMonthView:Boolean,events:[Array,Function],eventColor:[String,Function],emitImmediately:Boolean,options:[Array,Function],navigationMinYearMonth:{type:String,validator:vt},navigationMaxYearMonth:{type:String,validator:vt},noUnset:Boolean,firstDayOfWeek:[String,Number],todayBtn:Boolean,minimal:Boolean,defaultView:{type:String,default:"Calendar",validator:Dt}},emits:[...zt,"rangeStart","rangeEnd","navigation"],setup(e,{slots:u,emit:p}){const{proxy:V}=ht(),{$q:q}=V,A=Pt(e,q),{getCache:v}=Va(),{tabindex:b,headerClass:Y,getLocale:r,getCurrentDate:$}=Jt(e,q);let M;const E=xt(e),G=$t(E),Z=S(null),P=S(Xe()),D=S(r()),fe=m(()=>Xe()),ue=m(()=>r()),w=m(()=>$()),l=S(o(P.value,D.value)),y=S(e.defaultView),le=q.lang.rtl===!0?"right":"left",W=S(le.value),N=S(le.value),je=l.value.year,he=S(je-je%we-(je<0?we:0)),Q=S(null),ye=m(()=>{const t=e.landscape===!0?"landscape":"portrait";return`q-date q-date--${t} q-date--${t}-${e.minimal===!0?"minimal":"standard"}`+(A.value===!0?" q-date--dark q-dark":"")+(e.bordered===!0?" q-date--bordered":"")+(e.square===!0?" q-date--square no-border-radius":"")+(e.flat===!0?" q-date--flat no-shadow":"")+(e.disable===!0?" disabled":e.readonly===!0?" q-date--readonly":"")}),X=m(()=>e.color||"primary"),ee=m(()=>e.textColor||"white"),z=m(()=>e.emitImmediately===!0&&e.multiple!==!0&&e.range!==!0),ie=m(()=>Array.isArray(e.modelValue)===!0?e.modelValue:e.modelValue!==null&&e.modelValue!==void 0?[e.modelValue]:[]),U=m(()=>ie.value.filter(t=>typeof t=="string").map(t=>Be(t,P.value,D.value)).filter(t=>t.dateHash!==null&&t.day!==null&&t.month!==null&&t.year!==null)),te=m(()=>{const t=a=>Be(a,P.value,D.value);return ie.value.filter(a=>la(a)===!0&&a.from!==void 0&&a.to!==void 0).map(a=>({from:t(a.from),to:t(a.to)})).filter(a=>a.from.dateHash!==null&&a.to.dateHash!==null&&a.from.dateHash<a.to.dateHash)}),Ce=m(()=>e.calendar!=="persian"?t=>new Date(t.year,t.month-1,t.day):t=>{const a=qt(t.year,t.month,t.day);return new Date(a.gy,a.gm-1,a.gd)}),Te=m(()=>e.calendar==="persian"?se:(t,a,n)=>Ft(new Date(t.year,t.month-1,t.day,t.hour,t.minute,t.second,t.millisecond),a===void 0?P.value:a,n===void 0?D.value:n,t.year,t.timezoneOffset)),de=m(()=>U.value.length+te.value.reduce((t,a)=>t+1+fa(Ce.value(a.to),Ce.value(a.from)),0)),ge=m(()=>{if(e.title!==void 0&&e.title!==null&&e.title.length>0)return e.title;if(Q.value!==null){const n=Q.value.init,c=Ce.value(n);return D.value.daysShort[c.getDay()]+", "+D.value.monthsShort[n.month-1]+" "+n.day+He+"?"}if(de.value===0)return He;if(de.value>1)return`${de.value} ${D.value.pluralDay}`;const t=U.value[0],a=Ce.value(t);return isNaN(a.valueOf())===!0?He:D.value.headerTitle!==void 0?D.value.headerTitle(a,t):D.value.daysShort[a.getDay()]+", "+D.value.monthsShort[t.month-1]+" "+t.day}),Qe=m(()=>U.value.concat(te.value.map(a=>a.from)).sort((a,n)=>a.year-n.year||a.month-n.month)[0]),Oe=m(()=>U.value.concat(te.value.map(a=>a.to)).sort((a,n)=>n.year-a.year||n.month-a.month)[0]),ze=m(()=>{if(e.subtitle!==void 0&&e.subtitle!==null&&e.subtitle.length>0)return e.subtitle;if(de.value===0)return He;if(de.value>1){const t=Qe.value,a=Oe.value,n=D.value.monthsShort;return n[t.month-1]+(t.year!==a.year?" "+t.year+He+n[a.month-1]+" ":t.month!==a.month?He+n[a.month-1]:"")+" "+a.year}return U.value[0].year}),qe=m(()=>{const t=[q.iconSet.datetime.arrowLeft,q.iconSet.datetime.arrowRight];return q.lang.rtl===!0?t.reverse():t}),Me=m(()=>e.firstDayOfWeek!==void 0?Number(e.firstDayOfWeek):D.value.firstDayOfWeek),Ye=m(()=>{const t=D.value.daysShort,a=Me.value;return a>0?t.slice(a,7).concat(t.slice(0,a)):t}),ne=m(()=>{const t=l.value;return e.calendar!=="persian"?new Date(t.year,t.month,0).getDate():dt(t.year,t.month)}),Je=m(()=>typeof e.eventColor=="function"?e.eventColor:()=>e.eventColor),I=m(()=>{if(e.navigationMinYearMonth===void 0)return null;const t=e.navigationMinYearMonth.split("/");return{year:parseInt(t[0],10),month:parseInt(t[1],10)}}),F=m(()=>{if(e.navigationMaxYearMonth===void 0)return null;const t=e.navigationMaxYearMonth.split("/");return{year:parseInt(t[0],10),month:parseInt(t[1],10)}}),Ae=m(()=>{const t={month:{prev:!0,next:!0},year:{prev:!0,next:!0}};return I.value!==null&&I.value.year>=l.value.year&&(t.year.prev=!1,I.value.year===l.value.year&&I.value.month>=l.value.month&&(t.month.prev=!1)),F.value!==null&&F.value.year<=l.value.year&&(t.year.next=!1,F.value.year===l.value.year&&F.value.month<=l.value.month&&(t.month.next=!1)),t}),De=m(()=>{const t={};return U.value.forEach(a=>{const n=ce(a);t[n]===void 0&&(t[n]=[]),t[n].push(a.day)}),t}),Re=m(()=>{const t={};return te.value.forEach(a=>{const n=ce(a.from),c=ce(a.to);if(t[n]===void 0&&(t[n]=[]),t[n].push({from:a.from.day,to:n===c?a.to.day:void 0,range:a}),n<c){let d;const{year:H,month:f}=a.from,_=f<12?{year:H,month:f+1}:{year:H+1,month:1};for(;(d=ce(_))<=c;)t[d]===void 0&&(t[d]=[]),t[d].push({from:void 0,to:d===c?a.to.day:void 0,range:a}),_.month++,_.month>12&&(_.year++,_.month=1)}}),t}),pe=m(()=>{if(Q.value===null)return;const{init:t,initHash:a,final:n,finalHash:c}=Q.value,[d,H]=a<=c?[t,n]:[n,t],f=ce(d),_=ce(H);if(f!==J.value&&_!==J.value)return;const T={};return f===J.value?(T.from=d.day,T.includeFrom=!0):T.from=1,_===J.value?(T.to=H.day,T.includeTo=!0):T.to=ne.value,T}),J=m(()=>ce(l.value)),lt=m(()=>{const t={};if(e.options===void 0){for(let n=1;n<=ne.value;n++)t[n]=!0;return t}const a=typeof e.options=="function"?e.options:n=>e.options.includes(n);for(let n=1;n<=ne.value;n++){const c=J.value+"/"+L(n);t[n]=a(c)}return t}),nt=m(()=>{const t={};if(e.events===void 0)for(let a=1;a<=ne.value;a++)t[a]=!1;else{const a=typeof e.events=="function"?e.events:n=>e.events.includes(n);for(let n=1;n<=ne.value;n++){const c=J.value+"/"+L(n);t[n]=a(c)===!0&&Je.value(c)}}return t}),Se=m(()=>{let t,a;const{year:n,month:c}=l.value;if(e.calendar!=="persian")t=new Date(n,c-1,1),a=new Date(n,c-1,0).getDate();else{const d=qt(n,c,1);t=new Date(d.gy,d.gm-1,d.gd);let H=c-1,f=n;H===0&&(H=12,f--),a=dt(f,H)}return{days:t.getDay()-Me.value-1,endDay:a}}),be=m(()=>{const t=[],{days:a,endDay:n}=Se.value,c=a<0?a+7:a;if(c<6)for(let f=n-c;f<=n;f++)t.push({i:f,fill:!0});const d=t.length;for(let f=1;f<=ne.value;f++){const _={i:f,event:nt.value[f],classes:[]};lt.value[f]===!0&&(_.in=!0,_.flat=!0),t.push(_)}if(De.value[J.value]!==void 0&&De.value[J.value].forEach(f=>{const _=d+f-1;Object.assign(t[_],{selected:!0,unelevated:!0,flat:!1,color:X.value,textColor:ee.value})}),Re.value[J.value]!==void 0&&Re.value[J.value].forEach(f=>{if(f.from!==void 0){const _=d+f.from-1,T=d+(f.to||ne.value)-1;for(let rt=_;rt<=T;rt++)Object.assign(t[rt],{range:f.range,unelevated:!0,color:X.value,textColor:ee.value});Object.assign(t[_],{rangeFrom:!0,flat:!1}),f.to!==void 0&&Object.assign(t[T],{rangeTo:!0,flat:!1})}else if(f.to!==void 0){const _=d+f.to-1;for(let T=d;T<=_;T++)Object.assign(t[T],{range:f.range,unelevated:!0,color:X.value,textColor:ee.value});Object.assign(t[_],{flat:!1,rangeTo:!0})}else{const _=d+ne.value-1;for(let T=d;T<=_;T++)Object.assign(t[T],{range:f.range,unelevated:!0,color:X.value,textColor:ee.value})}}),pe.value!==void 0){const f=d+pe.value.from-1,_=d+pe.value.to-1;for(let T=f;T<=_;T++)t[T].color=X.value,t[T].editRange=!0;pe.value.includeFrom===!0&&(t[f].editRangeFrom=!0),pe.value.includeTo===!0&&(t[_].editRangeTo=!0)}l.value.year===w.value.year&&l.value.month===w.value.month&&(t[d+w.value.day-1].today=!0);const H=t.length%7;if(H>0){const f=7-H;for(let _=1;_<=f;_++)t.push({i:_,fill:!0})}return t.forEach(f=>{let _="q-date__calendar-item ";f.fill===!0?_+="q-date__calendar-item--fill":(_+=`q-date__calendar-item--${f.in===!0?"in":"out"}`,f.range!==void 0&&(_+=` q-date__range${f.rangeTo===!0?"-to":f.rangeFrom===!0?"-from":""}`),f.editRange===!0&&(_+=` q-date__edit-range${f.editRangeFrom===!0?"-from":""}${f.editRangeTo===!0?"-to":""}`),(f.range!==void 0||f.editRange===!0)&&(_+=` text-${f.color}`)),f.classes=_}),t}),Ve=m(()=>e.disable===!0?{"aria-disabled":"true"}:e.readonly===!0?{"aria-readonly":"true"}:{});oe(()=>e.modelValue,t=>{if(M===t)M=0;else{const{year:a,month:n}=o(P.value,D.value);R(a,n)}}),oe(y,()=>{Z.value!==null&&V.$el.contains(document.activeElement)===!0&&Z.value.focus()}),oe(()=>l.value.year,t=>{p("navigation",{year:t,month:l.value.month})}),oe(()=>l.value.month,t=>{p("navigation",{year:l.value.year,month:t})}),oe(fe,t=>{_t(t,D.value,"mask"),P.value=t}),oe(ue,t=>{_t(P.value,t,"locale"),D.value=t});function Ke(){const t=w.value,a=De.value[ce(t)];(a===void 0||a.includes(t.day)===!1)&&ot(t),re(t.year,t.month)}function Le(t){Dt(t)===!0&&(y.value=t)}function We(t,a){["month","year"].includes(t)&&(t==="month"?g:k)(a===!0?-1:1)}function re(t,a){y.value="Calendar",R(t,a)}function Ie(t,a){if(e.range===!1||!t){Q.value=null;return}const n=Object.assign({...l.value},t),c=a!==void 0?Object.assign({...l.value},a):n;Q.value={init:n,initHash:se(n),final:c,finalHash:se(c)},re(n.year,n.month)}function Xe(){return e.calendar==="persian"?"YYYY/MM/DD":e.mask}function Be(t,a,n){return Ee(t,a,n,e.calendar,{hour:0,minute:0,second:0,millisecond:0})}function o(t,a){const n=Array.isArray(e.modelValue)===!0?e.modelValue:e.modelValue?[e.modelValue]:[];if(n.length===0)return i();const c=n[n.length-1],d=Be(c.from!==void 0?c.from:c,t,a);return d.dateHash===null?i():d}function i(){let t,a;if(e.defaultYearMonth!==void 0){const n=e.defaultYearMonth.split("/");t=parseInt(n[0],10),a=parseInt(n[1],10)}else{const n=w.value!==void 0?w.value:$();t=n.year,a=n.month}return{year:t,month:a,day:1,hour:0,minute:0,second:0,millisecond:0,dateHash:t+"/"+L(a)+"/01"}}function g(t){let a=l.value.year,n=Number(l.value.month)+t;n===13?(n=1,a++):n===0&&(n=12,a--),R(a,n),z.value===!0&&Pe("month")}function k(t){const a=Number(l.value.year)+t;R(a,l.value.month),z.value===!0&&Pe("year")}function j(t){R(t,l.value.month),y.value=e.defaultView==="Years"?"Months":"Calendar",z.value===!0&&Pe("year")}function K(t){R(l.value.year,t),y.value="Calendar",z.value===!0&&Pe("month")}function C(t,a){const n=De.value[a];(n!==void 0&&n.includes(t.day)===!0?ut:ot)(t)}function O(t){return{year:t.year,month:t.month,day:t.day}}function R(t,a){I.value!==null&&t<=I.value.year&&(t=I.value.year,a<I.value.month&&(a=I.value.month)),F.value!==null&&t>=F.value.year&&(t=F.value.year,a>F.value.month&&(a=F.value.month));const n=t+"/"+L(a)+"/01";n!==l.value.dateHash&&(W.value=l.value.dateHash<n==(q.lang.rtl!==!0)?"left":"right",t!==l.value.year&&(N.value=W.value),et(()=>{he.value=t-t%we-(t<0?we:0),Object.assign(l.value,{year:t,month:a,day:1,dateHash:n})}))}function Ge(t,a,n){const c=t!==null&&t.length===1&&e.multiple===!1?t[0]:t;M=c;const{reason:d,details:H}=wt(a,n);p("update:modelValue",c,d,H)}function Pe(t){const a=U.value[0]!==void 0&&U.value[0].dateHash!==null?{...U.value[0]}:{...l.value};et(()=>{a.year=l.value.year,a.month=l.value.month;const n=e.calendar!=="persian"?new Date(a.year,a.month,0).getDate():dt(a.year,a.month);a.day=Math.min(Math.max(1,a.day),n);const c=xe(a);M=c;const{details:d}=wt("",a);p("update:modelValue",c,t,d)})}function wt(t,a){return a.from!==void 0?{reason:`${t}-range`,details:{...O(a.target),from:O(a.from),to:O(a.to)}}:{reason:`${t}-day`,details:O(a)}}function xe(t,a,n){return t.from!==void 0?{from:Te.value(t.from,a,n),to:Te.value(t.to,a,n)}:Te.value(t,a,n)}function ot(t){let a;if(e.multiple===!0)if(t.from!==void 0){const n=se(t.from),c=se(t.to),d=U.value.filter(f=>f.dateHash<n||f.dateHash>c),H=te.value.filter(({from:f,to:_})=>_.dateHash<n||f.dateHash>c);a=d.concat(H).concat(t).map(f=>xe(f))}else{const n=ie.value.slice();n.push(xe(t)),a=n}else a=xe(t);Ge(a,"add",t)}function ut(t){if(e.noUnset===!0)return;let a=null;if(e.multiple===!0&&Array.isArray(e.modelValue)===!0){const n=xe(t);t.from!==void 0?a=e.modelValue.filter(c=>c.from!==void 0?c.from!==n.from&&c.to!==n.to:!0):a=e.modelValue.filter(c=>c!==n),a.length===0&&(a=null)}Ge(a,"remove",t)}function _t(t,a,n){const c=U.value.concat(te.value).map(d=>xe(d,t,a)).filter(d=>d.from!==void 0?d.from.dateHash!==null&&d.to.dateHash!==null:d.dateHash!==null);p("update:modelValue",(e.multiple===!0?c:c[0])||null,n)}function Rt(){if(e.minimal!==!0)return s("div",{class:"q-date__header "+Y.value},[s("div",{class:"relative-position"},[s($e,{name:"q-transition--fade"},()=>s("div",{key:"h-yr-"+ze.value,class:"q-date__header-subtitle q-date__header-link "+(y.value==="Years"?"q-date__header-link--active":"cursor-pointer"),tabindex:b.value,...v("vY",{onClick(){y.value="Years"},onKeyup(t){t.keyCode===13&&(y.value="Years")}})},[ze.value]))]),s("div",{class:"q-date__header-title relative-position flex no-wrap"},[s("div",{class:"relative-position col"},[s($e,{name:"q-transition--fade"},()=>s("div",{key:"h-sub"+ge.value,class:"q-date__header-title-label q-date__header-link "+(y.value==="Calendar"?"q-date__header-link--active":"cursor-pointer"),tabindex:b.value,...v("vC",{onClick(){y.value="Calendar"},onKeyup(t){t.keyCode===13&&(y.value="Calendar")}})},[ge.value]))]),e.todayBtn===!0?s(B,{class:"q-date__header-today self-start",icon:q.iconSet.datetime.today,flat:!0,size:"sm",round:!0,tabindex:b.value,onClick:Ke}):null])])}function it({label:t,type:a,key:n,dir:c,goTo:d,boundaries:H,cls:f}){return[s("div",{class:"row items-center q-date__arrow"},[s(B,{round:!0,dense:!0,size:"sm",flat:!0,icon:qe.value[0],tabindex:b.value,disable:H.prev===!1,...v("go-#"+a,{onClick(){d(-1)}})})]),s("div",{class:"relative-position overflow-hidden flex flex-center"+f},[s($e,{name:"q-transition--jump-"+c},()=>s("div",{key:n},[s(B,{flat:!0,dense:!0,noCaps:!0,label:t,tabindex:b.value,...v("view#"+a,{onClick:()=>{y.value=a}})})]))]),s("div",{class:"row items-center q-date__arrow"},[s(B,{round:!0,dense:!0,size:"sm",flat:!0,icon:qe.value[1],tabindex:b.value,disable:H.next===!1,...v("go+#"+a,{onClick(){d(1)}})})])]}const Kt={Calendar:()=>[s("div",{key:"calendar-view",class:"q-date__view q-date__calendar"},[s("div",{class:"q-date__navigation row items-center no-wrap"},it({label:D.value.months[l.value.month-1],type:"Months",key:l.value.month,dir:W.value,goTo:g,boundaries:Ae.value.month,cls:" col"}).concat(it({label:l.value.year,type:"Years",key:l.value.year,dir:N.value,goTo:k,boundaries:Ae.value.year,cls:""}))),s("div",{class:"q-date__calendar-weekdays row items-center no-wrap"},Ye.value.map(t=>s("div",{class:"q-date__calendar-item"},[s("div",t)]))),s("div",{class:"q-date__calendar-days-container relative-position overflow-hidden"},[s($e,{name:"q-transition--slide-"+W.value},()=>s("div",{key:J.value,class:"q-date__calendar-days fit"},be.value.map(t=>s("div",{class:t.classes},[t.in===!0?s(B,{class:t.today===!0?"q-date__today":"",dense:!0,flat:t.flat,unelevated:t.unelevated,color:t.color,textColor:t.textColor,label:t.i,tabindex:b.value,...v("day#"+t.i,{onClick:()=>{Lt(t.i)},onMouseover:()=>{Wt(t.i)}})},t.event!==!1?()=>s("div",{class:"q-date__event bg-"+t.event}):null):s("div",""+t.i)]))))])])],Months(){const t=l.value.year===w.value.year,a=c=>I.value!==null&&l.value.year===I.value.year&&I.value.month>c||F.value!==null&&l.value.year===F.value.year&&F.value.month<c,n=D.value.monthsShort.map((c,d)=>{const H=l.value.month===d+1;return s("div",{class:"q-date__months-item flex flex-center"},[s(B,{class:t===!0&&w.value.month===d+1?"q-date__today":null,flat:H!==!0,label:c,unelevated:H,color:H===!0?X.value:null,textColor:H===!0?ee.value:null,tabindex:b.value,disable:a(d+1),...v("month#"+d,{onClick:()=>{K(d+1)}})})])});return e.yearsInMonthView===!0&&n.unshift(s("div",{class:"row no-wrap full-width"},[it({label:l.value.year,type:"Years",key:l.value.year,dir:N.value,goTo:k,boundaries:Ae.value.year,cls:" col"})])),s("div",{key:"months-view",class:"q-date__view q-date__months flex flex-center"},n)},Years(){const t=he.value,a=t+we,n=[],c=d=>I.value!==null&&I.value.year>d||F.value!==null&&F.value.year<d;for(let d=t;d<=a;d++){const H=l.value.year===d;n.push(s("div",{class:"q-date__years-item flex flex-center"},[s(B,{key:"yr"+d,class:w.value.year===d?"q-date__today":null,flat:!H,label:d,dense:!0,unelevated:H,color:H===!0?X.value:null,textColor:H===!0?ee.value:null,tabindex:b.value,disable:c(d),...v("yr#"+d,{onClick:()=>{j(d)}})})]))}return s("div",{class:"q-date__view q-date__years flex flex-center"},[s("div",{class:"col-auto"},[s(B,{round:!0,dense:!0,flat:!0,icon:qe.value[0],tabindex:b.value,disable:c(t),...v("y-",{onClick:()=>{he.value-=we}})})]),s("div",{class:"q-date__years-content col self-stretch row items-center"},n),s("div",{class:"col-auto"},[s(B,{round:!0,dense:!0,flat:!0,icon:qe.value[1],tabindex:b.value,disable:c(a),...v("y+",{onClick:()=>{he.value+=we}})})])])}};function Lt(t){const a={...l.value,day:t};if(e.range===!1){C(a,J.value);return}if(Q.value===null){const n=be.value.find(d=>d.fill!==!0&&d.i===t);if(e.noUnset!==!0&&n.range!==void 0){ut({target:a,from:n.range.from,to:n.range.to});return}if(n.selected===!0){ut(a);return}const c=se(a);Q.value={init:a,initHash:c,final:a,finalHash:c},p("rangeStart",O(a))}else{const n=Q.value.initHash,c=se(a),d=n<=c?{from:Q.value.init,to:a}:{from:a,to:Q.value.init};Q.value=null,ot(n===c?a:{target:a,...d}),p("rangeEnd",{from:O(d.from),to:O(d.to)})}}function Wt(t){if(Q.value!==null){const a={...l.value,day:t};Object.assign(Q.value,{final:a,finalHash:se(a)})}}return Object.assign(V,{setToday:Ke,setView:Le,offsetCalendar:We,setCalendarTo:re,setEditingRange:Ie}),()=>{const t=[s("div",{class:"q-date__content col relative-position"},[s($e,{name:"q-transition--fade"},Kt[y.value])])],a=Ht(u.default);return a!==void 0&&t.push(s("div",{class:"q-date__actions"},a)),e.name!==void 0&&e.disable!==!0&&G(t,"push"),s("div",{class:ye.value,...Ve.value},[Rt(),s("div",{ref:Z,class:"q-date__main col column",tabindex:-1},t)])}}}),Ha=tt({name:"UiInput",inheritAttrs:!1,props:{modelValue:{required:!0},options:{required:!0},optionLabel:{required:!0},rules:{type:Array}},emits:["update:modelValue"],setup(e,{emit:u}){return{localModel:S(e.modelValue),handleUpdate(V){u("update:modelValue",V)}}}});function $a(e,u,p,V,q,A){return ae(),gt(Ne,na({modelValue:e.localModel,"onUpdate:modelValue":u[0]||(u[0]=v=>e.localModel=v),outlined:"",dense:"",options:e.options,"option-label":e.optionLabel,"lazy-rules":"",rules:e.rules},e.$attrs,{"onUpdate:modelValue":e.handleUpdate}),null,16,["modelValue","options","option-label","rules","onUpdate:modelValue"])}const ja=at(Ha,[["render",$a]]),Ta=tt({name:"FormTaskParam",components:{UiInputVue:Et},emits:["cancel","submit"],setup(e,{emit:u}){const p=S(null),V=S([]),{localProp:q,show:A,handleSubmit:v,handleCancel:b}=Nt(p,u);return{localProp:q,popup:p,params:V,show(Y){const{row:r,params:$}={...Y};V.value=$,A(r)},handleSubmit:v,handleCancel:b}}});function Oa(e,u,p,V,q,A){const v=ke("ui-input-vue");return ae(),gt(yt,{ref:"popup","transition-show":"rotate","transition-hide":"rotate",persistent:""},{default:x(()=>[h(bt,{style:{"min-width":"300px"}},{default:x(()=>[h(pt,null,{default:x(()=>[h(Ut,{class:"q-gutter-md",onSubmit:jt(e.handleSubmit,["prevent"])},{default:x(()=>[h(Ne,{modelValue:e.localProp.name,"onUpdate:modelValue":u[0]||(u[0]=b=>e.localProp.name=b),outlined:"",dense:"",options:e.params,"option-label":"name","option-value":"name",hint:"Parameter name *","emit-value":"","map-options":"","lazy-rules":"",rules:[b=>b&&b.length>0||"Please select something"]},null,8,["modelValue","options","rules"]),h(v,{modelValue:e.localProp.value,"onUpdate:modelValue":u[1]||(u[1]=b=>e.localProp.value=b),hint:"Parameter value *"},null,8,["modelValue"]),h(Tt,{align:"left",class:"text-primary"},{default:x(()=>[h(B,{label:"Submit",type:"submit",color:"primary"}),h(B,{label:"Cancel",color:"primary",flat:"",class:"q-ml-sm",onClick:e.handleCancel},null,8,["onClick"])]),_:1})]),_:1},8,["onSubmit"])]),_:1})]),_:1})]),_:1},512)}const Ya=at(Ta,[["render",Oa]]);async function Aa(){const e=[];return me.get("/schedule/executors").then(({success:u,result:p})=>u?p:e).catch(()=>e)}async function Ia(){const e=[];return me.get("/schedule/tasks").then(({success:u,result:p})=>u?p:e).catch(()=>e)}async function Ba(){const e=[];return me.get("/schedule/periods").then(({success:u,result:p})=>u?p:e).catch(()=>e)}const Fa=[{name:"name",align:"left",field:"name",style:"max-width: 40px; width: 40px;"},{name:"value",align:"left",field:"value",style:"font-style: italic; max-width: 70px; width: 70px;"},{name:"job_id"},{name:"actions"}],Ua=tt({name:"FormJob",components:{UiInputVue:Et,UiRoundBtnVue:Bt,UiSelectVue:ja,FormJobParamVue:Ya},emits:["cancel","submit"],setup(e,{emit:u}){const p=S(null),V=S(null),q=S(!1),A=m(()=>q.value?"<<":">>"),{localProp:v,show:b,handleSubmit:Y,handleCancel:r}=Nt(p,u),$=ga(),M=S(!0),E=S(!1),G=S([]),Z=S([]),P=S([]),D=S(null);let fe=null;const{isTime:ue,isDate:w}=ha();return oe(v,async(l,y)=>{M.value=l!=null&&l.period?l.period.id!=="once":!1,E.value=!(l!=null&&l.task),await et(),y&&(l!=null&&l.period)&&(D!=null&&D.value)&&l.period.id!==fe&&(D.value.focus(),fe=l.period.id)},{deep:!0}),Ot(async()=>{G.value=await Aa(),Z.value=await Ia(),P.value=await Ba()}),{localProp:v,popup:p,form:V,columns:Fa,confirm:$,labelBtnParams:A,showValue:M,showParams:q,paramsDisabled:E,periodState:m(()=>M.value?"with-value":"wd-320"),executors:G,tasks:Z,periods:P,periodValue:D,showBtnAddParam:m(()=>{var l;return q.value?(l=v.value)!=null&&l.params?v.value.params.length===0:!0:!1}),validTime:l=>{var y;return(y=v.value)!=null&&y.period&&["once","day","week","month","year"].includes(v.value.period.id)?ue(l):!l||!l.length?!0:ue(l)},validDate:l=>{var y;return(y=v.value)!=null&&y.period&&(v.value.period.id==="month"||v.value.period.id==="year")?w(l):!l||!l.length?!0:w(l)},moreThanNow:(l,y,le)=>{try{if(!l||l.length===0||!y||y.length===0||le&&le!=="0")return!0;const W=ct.formatDate(y+" "+l,"YYYY-MM-DD HH:mm:ss");return ct.formatDate(W,"X")>ct.formatDate(new Date,"X")}catch(W){return console.log(W),!1}},show:b,handleSubmit(){var y,le;v.value.task.params.length===0&&!((y=v.value)!=null&&y.params)||!!((le=v.value)!=null&&le.params)&&v.value.params.length===v.value.task.params.length?Y():(Yt.create({type:"negative",message:"The number of task and job parameters do not match!"}),q.value=!0)},handleCancel:r,handleAdd(){V.value.show({row:{},params:v.value.task.params})},handleEdit(l){V.value.show({row:l,params:v.value.task.params})},async handleDelete(l){await $.show("Are you sure to delete this item?")&&l!==-1&&v.value.params.splice(l,1)},handleParamSubmit(l){var y;l.update||((y=v.value)!=null&&y.params||(v.value.params=[]),v.value.params.push(l.data))}}}}),Ea={class:"row"},Na={key:0,class:"wd-70"},Qa={class:"row items-center justify-end"},za={class:"row items-center justify-end"},Ja={key:0},Ra={key:1};function Ka(e,u,p,V,q,A){const v=ke("ui-input-vue"),b=ke("ui-round-btn-vue"),Y=ke("form-job-param-vue");return ae(),ve(At,null,[h(yt,{ref:"popup","transition-show":"rotate","transition-hide":"rotate",persistent:""},{default:x(()=>[h(bt,{style:{"min-width":"350px"}},{default:x(()=>[h(pt,null,{default:x(()=>[h(Ut,{class:"q-gutter-md",onSubmit:jt(e.handleSubmit,["prevent"])},{default:x(()=>[h(oa,{modelValue:e.localProp.verbose,"onUpdate:modelValue":u[0]||(u[0]=r=>e.localProp.verbose=r),label:"Verbose"},null,8,["modelValue"]),h(v,{modelValue:e.localProp.note,"onUpdate:modelValue":u[1]||(u[1]=r=>e.localProp.note=r),hint:"Job description *"},null,8,["modelValue"]),h(Ne,{modelValue:e.localProp.task,"onUpdate:modelValue":u[2]||(u[2]=r=>e.localProp.task=r),outlined:"",dense:"",options:e.tasks,"option-label":"name",hint:"Task *","lazy-rules":"",rules:[r=>r||"Please select something"]},null,8,["modelValue","options","rules"]),h(Ne,{modelValue:e.localProp.executor,"onUpdate:modelValue":u[3]||(u[3]=r=>e.localProp.executor=r),outlined:"",dense:"",options:e.executors,"option-label":"name",hint:"Executor *","lazy-rules":"",rules:[()=>e.localProp.executor||"Please select something"]},null,8,["modelValue","options","rules"]),Ue("div",Ea,[e.showValue?(ae(),ve("div",Na,[h(st,{ref:"periodValue",modelValue:e.localProp.value,"onUpdate:modelValue":u[4]||(u[4]=r=>e.localProp.value=r),modelModifiers:{number:!0},type:"number",outlined:"",dense:"",class:"mr-5"},null,8,["modelValue"])])):_e("",!0),Ue("div",{class:ua(e.periodState)},[h(Ne,{modelValue:e.localProp.period,"onUpdate:modelValue":u[5]||(u[5]=r=>e.localProp.period=r),outlined:"",dense:"",options:e.periods,"option-label":"name",hint:"Period *","reactive-rules":"","lazy-rules":"",rules:[r=>r||"Please select something"]},null,8,["modelValue","options","rules"])],2)]),h(st,{modelValue:e.localProp.time,"onUpdate:modelValue":u[7]||(u[7]=r=>e.localProp.time=r),outlined:"",dense:"",type:"time",step:"2",hint:"Start time","reactive-rules":"","lazy-rules":"",rules:[r=>e.validTime(r)||"Please type time",r=>e.moreThanNow(r,e.localProp.date,e.localProp.value)||"Time has expired"]},{append:x(()=>[h(kt,{name:"access_time",class:"cursor-pointer"},{default:x(()=>[h(Mt,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:x(()=>[h(Sa,{modelValue:e.localProp.time,"onUpdate:modelValue":u[6]||(u[6]=r=>e.localProp.time=r),mask:"HH:mm:ss",format24h:"","with-seconds":""},{default:x(()=>[Ue("div",Qa,[mt(h(B,{label:"Close",color:"primary",flat:""},null,512),[[Ct]])])]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue","rules"]),h(st,{modelValue:e.localProp.date,"onUpdate:modelValue":u[9]||(u[9]=r=>e.localProp.date=r),outlined:"",dense:"",type:"date",hint:"Start date","reactive-rules":"","lazy-rules":"",rules:[r=>e.validDate(r)||"Incorrect date",r=>e.moreThanNow(e.localProp.time,r,e.localProp.value)||"Time has expired"]},{append:x(()=>[h(kt,{name:"event",class:"cursor-pointer"},{default:x(()=>[h(Mt,{cover:"","transition-show":"scale","transition-hide":"scale"},{default:x(()=>[h(xa,{modelValue:e.localProp.date,"onUpdate:modelValue":u[8]||(u[8]=r=>e.localProp.date=r),mask:"YYYY-MM-DD"},{default:x(()=>[Ue("div",za,[mt(h(B,{label:"Close",color:"primary",flat:""},null,512),[[Ct]])])]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue","rules"]),h(B,{dense:"",disable:e.paramsDisabled,class:"wd-320",outline:"",color:"grey",label:e.labelBtnParams,onClick:u[10]||(u[10]=r=>e.showParams=!e.showParams)},null,8,["disable","label"]),e.showParams?(ae(),ve("div",Ja,[h(It,{"hide-header":"","hide-bottom":"",rows:e.localProp.params,columns:e.columns,"row-key":"name"},{"body-cell-actions":x(r=>[h(Ze,{props:r},{default:x(()=>[h(b,{color:"primary",icon:"add",tooltip:"Create parameter",onClick:e.handleAdd},null,8,["onClick"]),h(b,{color:"positive",icon:"mode_edit",tooltip:"Edit parameter",onClick:$=>e.handleEdit(r.row)},null,8,["onClick"]),h(b,{color:"negative",icon:"delete",tooltip:"Delete parameter",onClick:$=>e.handleDelete(r.rowIndex)},null,8,["onClick"])]),_:2},1032,["props"])]),_:1},8,["rows","columns"])])):_e("",!0),e.showBtnAddParam?(ae(),ve("div",Ra,[h(B,{class:"wd-320",dense:"",label:"Add",color:"primary",onClick:u[11]||(u[11]=r=>e.handleAdd())})])):_e("",!0),h(Tt,{align:"left",class:"text-primary"},{default:x(()=>[h(B,{label:"Submit",type:"submit",color:"primary"}),h(B,{label:"Cancel",color:"primary",flat:"",class:"q-ml-sm",onClick:e.handleCancel},null,8,["onClick"])]),_:1})]),_:1},8,["onSubmit"])]),_:1})]),_:1})]),_:1},512),h(Y,{ref:"form",onSubmit:e.handleParamSubmit},null,8,["onSubmit"])],64)}const La=at(Ua,[["render",Ka],["__scopeId","data-v-cda42d3b"]]);const Wa=[{name:"state"},{name:"job"},{name:"actions"}],Xa=tt({name:"PageJobs",components:{UiBoxVue:sa,UiRoundBtnVue:Bt,FormJobVue:La},setup(){const e=S([]),u=ba(e),p=S(null),V=S({}),q={xl:5,lg:5,md:7,sm:11,xs:10},A=m(()=>e.value.length===0),v=S(!1),{handleAdd:b,handleEdit:Y,handleDelete:r,handleCancel:$}=ca(v,p,e,u,{verbose:!1});return Ot(async()=>e.value=await u.Get(!0)),ia(async()=>e.value=await u.Get(!1)),{columns:Wa,rows:e,task:V,buttonShow:A,wrapper:u,form:p,boxCols:q,visible:v,activeIcon:M=>M.active?"alarm":"alarm_off",activeColor:M=>M.active?"positive":"grey",oneToEmpty:M=>M<=1?" ":" "+M+" ",isTimeOrDate:(M,E)=>!!(M!=null&&M.length)||!!(E!=null&&E.length),handleAdd:b,handleEdit:Y,handleSubmit(M){M.update?_a(e,M.data):wa(e,M.data)},handleDelete:r,handleCancel:$,handleActivate:M=>{ka(M)},handleRun:async M=>{await Ca(M.id)&&Yt.create({type:"info",message:"Job completed"})}}}}),Ga={class:"text-subtitle1 text-bold text-left text-primary"},Za={key:0,class:"text-subtitle2 text-left"},el={key:1,class:"text-subtitle2 text-left"},tl={key:2,class:"text-subtitle2 text-left text-italic"};function al(e,u,p,V,q,A){const v=ke("ui-round-btn-vue"),b=ke("ui-box-vue"),Y=ke("form-job-vue");return ae(),ve(At,null,[h(b,{columns:e.boxCols,header:"Schedule Management",buttonShow:e.buttonShow,buttonLabel:"Add",buttonClick:e.handleAdd},{default:x(()=>[h(It,{"hide-header":"",dense:"",rows:e.rows,columns:e.columns,"row-key":"name","rows-per-page-options":[10,50,100,0]},{"body-cell-state":x(r=>[h(Ze,{props:r,class:"wd-70"},{default:x(()=>[h(B,{class:"q-ml-xs",dense:"",round:"",color:e.activeColor(r.row),size:"md",icon:e.activeIcon(r.row),onClick:$=>e.handleActivate(r.row)},{default:x(()=>[h(Zt,null,{default:x(()=>[ra("Activate/Deactivate job")]),_:1})]),_:2},1032,["color","icon","onClick"])]),_:2},1032,["props"])]),"body-cell-job":x(r=>[h(Ze,{props:r},{default:x(()=>[h(bt,{square:"",flat:""},{default:x(()=>[h(pt,{align:"left"},{default:x(()=>[Ue("div",Ga,Fe(r.row.note),1),r.row.period.id==="once"?(ae(),ve("div",Za,"Execute one time")):_e("",!0),r.row.period.id!=="once"?(ae(),ve("div",el," Repeate every"+Fe(e.oneToEmpty(r.row.value))+Fe(r.row.period.name.toLowerCase()),1)):_e("",!0),e.isTimeOrDate(r.row.time,r.row.date)?(ae(),ve("div",tl," Starting at "+Fe(r.row.time)+" "+Fe(r.row.date),1)):_e("",!0)]),_:2},1024)]),_:2},1024)]),_:2},1032,["props"])]),"body-cell-actions":x(r=>[h(Ze,{props:r},{default:x(()=>[h(v,{color:"primary",icon:"add",tooltip:"Create job",onClick:e.handleAdd},null,8,["onClick"]),h(v,{color:"primary",icon:"mdi-run",tooltip:"Run job",onClick:$=>e.handleRun(r.row)},null,8,["onClick"]),h(v,{color:"positive",icon:"mode_edit",tooltip:"Edit job",onClick:$=>e.handleEdit(r.row)},null,8,["onClick"]),h(v,{color:"negative",icon:"delete",tooltip:"Delete job",onClick:$=>e.handleDelete(r.row)},null,8,["onClick"])]),_:2},1032,["props"])]),_:1},8,["rows","columns"])]),_:1},8,["columns","buttonShow","buttonClick"]),e.visible?(ae(),gt(Y,{key:0,ref:"form",onSubmit:e.handleSubmit,onCancel:e.handleCancel},null,8,["onSubmit","onCancel"])):_e("",!0)],64)}const Ml=at(Xa,[["render",al],["__scopeId","data-v-e8e36e30"]]);export{Ml as default};
