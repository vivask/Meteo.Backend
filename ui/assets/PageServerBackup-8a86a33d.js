import{Q as B}from"./QMarkupTable-3806441a.js";import{U as L}from"./UiBox-438aefea.js";import{U as C,D as R,S as M}from"./ServerReboot-d6d987f6.js";import{U as $}from"./UiSquareBtn-3d095194.js";import{j as s}from"./jwtClient-fdc6c2bb.js";import{_ as k,a as V}from"./index-dc2fb6bd.js";import{K as _,g as d,o as f,f as S,L as h,M as b,c as P,r as w,aW as U,aV as A,aQ as K,O as q,P as W,R as E}from"./vendor-7e3b54f2.js";import"./QItemLabel-0efd9dc5.js";import"./QTooltip-cd4ef32e.js";import"./NetworkError-b28af479.js";async function D(){const e=[];try{const{success:t,result:r}=await s.get("/backup/state");return t?r:e}catch{return e}}async function G(){try{const{success:e}=await s.put("/backup/kodi/restart");return e}catch{return!1}}async function Q(e){const t=`/backup/storage/${e}`;try{const{success:r}=await s.put(t);return r}catch{return!1}}async function n(e){const t=`/backup/restart/${e}`;try{const{success:r}=await s.put(t);return r}catch{return!1}}async function l(e){const t=`/backup/stop/${e}`;try{const{success:r}=await s.put(t);return r}catch{return!1}}async function u(e){const t=`/backup/start/${e}`;try{const{success:r}=await s.put(t);return r}catch{return!1}}async function j(){try{const{success:e}=await s.put("/backup/reboot");return e}catch{return!1}}async function x(){try{const{success:e}=await s.put("/backup/shutdown");return e}catch{return!1}}async function i(e){const t=[],r=`/backup/logging/${e}`;try{const{success:p,result:v}=await s.get(r);return p?v:t}catch{return t}}async function c(e){const t=`/backup/logging/${e}`;try{const{success:r}=await s.put(t);return r}catch{return!1}}const I=_({name:"BackupKodi",components:{UiRowContainerVue:C,UiSquareBtnVue:$},props:{disable:{type:Boolean,default:!0}},setup(){return{RestartKodi:G}}});function N(e,t,r,p,v,g){const a=d("ui-square-btn-vue"),m=d("ui-row-container-vue");return f(),S(m,{title:"Kodi",healthy:!e.disable},{default:h(()=>[b(a,{tooltip:"Restart kodi daemon",color:"primary",icon:"mdi-restart",onClick:e.RestartKodi},null,8,["onClick"])]),_:1},8,["healthy"])}const T=k(I,[["render",N]]),F=_({name:"BackupStorage",components:{UiRowContainerVue:C,UiSquareBtnVue:$},props:{disable:{type:Boolean,default:!1}},setup(){return{StorageManipulation:Q}}});function O(e,t,r,p,v,g){const a=d("ui-square-btn-vue"),m=d("ui-row-container-vue");return f(),S(m,{title:"Storage",healthy:!e.disable},{default:h(()=>[b(a,{disable:e.disable,tooltip:"Remount storage",color:"primary",icon:"mdi-restart",onClick:t[0]||(t[0]=y=>e.StorageManipulation("restart"))},null,8,["disable"]),b(a,{disable:e.disable,tooltip:"Umount storage",color:"warning",icon:"link_off",onClick:t[1]||(t[1]=y=>e.StorageManipulation("stop"))},null,8,["disable"]),b(a,{disable:!e.disable,tooltip:"Mount storage",color:"primary",icon:"link",onClick:t[2]||(t[2]=y=>e.StorageManipulation("start"))},null,8,["disable"])]),_:1},8,["healthy"])}const z=k(F,[["render",O]]);function H(e){return P(()=>[{title:"Cluster",value:"cluster",disable:!e.value.ClusterService,empty:e.value.ClusterLog,logging:i,clear:c,restart:n,start:u,stop:l},{title:"Proxy",value:"proxy",disable:!e.value.ProxyService,empty:e.value.ProxyLog,logging:i,clear:c,restart:n,start:u,stop:l},{title:"Web",value:"web",disable:!e.value.WebService,empty:e.value.WebLog,logging:i,clear:c,restart:n,start:u,stop:l},{title:"Esp32",value:"esp32",disable:!e.value.Esp32Service,empty:e.value.Esp32Log,logging:i,clear:c,restart:n,start:u,stop:l},{title:"Sshclient",value:"sshclient",disable:!e.value.SshclientService,empty:e.value.SshclientLog,logging:i,clear:c,restart:n,start:u,stop:l},{title:"Schedule",value:"schedule",disable:!e.value.ScheduleService,empty:e.value.ScheduleLog,logging:i,clear:c,restart:n,start:u,stop:l},{title:"Messanger",value:"messanger",disable:!e.value.MessangerService,empty:e.value.MessangerLog,logging:i,clear:c,restart:n,start:u,stop:l},{title:"Radius",value:"radius",disable:!e.value.RadiusService,empty:e.value.RadiusLog,logging:i,clear:c,restart:n,start:u,stop:l},{title:"Postgres",value:"postgres",disable:!e.value.PostgresService,restart:n,start:u,stop:l}])}const J=_({name:"PageServerBackup",components:{UiBoxVue:L,BackupKodiVue:T,BackupStorageVue:z,DocockerServiceVue:R,ServerRebootVue:M},setup(){let e;const t={xl:5,lg:5,md:7,sm:11,xs:10},r=w({}),p=H(r),v=V(),g=w(!0);return U(()=>{e=setInterval(()=>{v.loggedIn&&g.value&&(g.value=!1,D().then(a=>{r.value=a,g.value=!0}).catch(()=>g.value=!0))},1e3)}),A(()=>{clearTimeout(e)}),{state:r,boxCols:t,services:p,Reboot:j,Shutdown:x,handleClearAll(){for(let a of p.value)a!=null&&a.clear&&c(a.value)}}}});function X(e,t,r,p,v,g){const a=d("dococker-service-vue"),m=d("server-reboot-vue"),y=d("ui-box-vue");return f(),S(y,{columns:e.boxCols,header:"Backup Server Management",buttonShow:!0,buttonLabel:"Clear All",buttonClick:e.handleClearAll,tooltip:"Clear all services log"},{default:h(()=>[b(B,null,{default:h(()=>[K("tbody",null,[(f(!0),q(E,null,W(e.services,o=>(f(),S(a,{key:o.value,value:o.value,title:o.title,disable:o.disable,"log-empty":o.empty,logging:o.logging,clear:o.clear,restart:o.restart,start:o.start,stop:o.stop},null,8,["value","title","disable","log-empty","logging","clear","restart","start","stop"]))),128)),b(m,{title:"Gk3",reboot:e.Reboot,shutdown:e.Shutdown,disable:!e.state.WebService},null,8,["reboot","shutdown","disable"])])]),_:1})]),_:1},8,["columns","buttonClick"])}const ue=k(J,[["render",X]]);export{ue as default};
